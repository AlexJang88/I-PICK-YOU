<!DOCTYPE html>
<html lang="en" class="light-style layout-menu-fixed" dir="ltr" data-theme="theme-default" data-assets-path="../assets/" data-template="vertical-menu-template-free" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0" />

    <title>건설일용근로자 표준근로계약서</title>

    <meta name="description" content="" />

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" th:href="@{/assets/img/favicon/favicon.ico}" />

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Public+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700&display=swap" rel="stylesheet" />

    <!-- Icons. Uncomment required icon fonts -->
    <link th:href="@{/assets/vendor/fonts/boxicons.css}" rel="stylesheet" />

    <!-- Core CSS -->
    <link th:href="@{/assets/vendor/css/core.css}" rel="stylesheet" class="template-customizer-core-css" />
    <link th:href="@{/assets/vendor/css/theme-default.css}" rel="stylesheet" class="template-customizer-theme-css" />
    <link th:href="@{/assets/css/demo.css}" rel="stylesheet" />

    <!-- Vendors CSS -->
    <link th:href="@{/assets/vendor/libs/perfect-scrollbar/perfect-scrollbar.css}" rel="stylesheet" />

    <!-- Helpers -->
    <script th:src="@{/assets/vendor/js/helpers.js}"></script>
    <script th:src="@{https://code.jquery.com/jquery-3.6.0.js}"></script>

    <!-- Template customizer & Theme config files -->
    <script th:src="@{/assets/js/config.js}"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
        }
        .container {
            width: 70%;
            margin: 0 auto;
            padding: 20px;
            border: 1px solid black;
        }
        .title {
            text-align: center;
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 20px;
        }
        .content {
            font-size: 14px;
        }
        .content table {
            width: 100%;
            border-collapse: collapse;
        }
        .content td, .content th {
            border: 1px solid black;
            padding: 8px;
            text-align: left;
        }
        .content th {
            background-color: #f2f2f2;
        }
        .content input[type="text"], .content input[type="date"] {
            width: 100%;
            border: none;
            border-bottom: 1px solid black;
            padding: 5px;
            outline: none;
        }
        .inline-input {
            border: none;
            border-bottom: 1px solid black;
            padding: 5px;
            outline: none;
            display: inline-block;
            width: auto;
            min-width: 100px;
        }
        h3{
            text-align : center;
        }
        h4{
            text-align:center;
        }
        .wrapper {
            position: relative;
            width: 400px;
            height: 200px;
            -moz-user-select: none;
            -webkit-user-select: none;
            -ms-user-select: none;
            user-select: none;
            display: none; /* Initially hidden */
        }

        .signature-pad {
            position: absolute;
            left: 0;
            top: 0;
            width: 400px;
            height: 200px;
            background-color: white;
        }

        .text {
            font-size: 30px;
            margin-top: 70px;
            vertical-align: middle;
            display: block; /* Initially visible */
        }

        #img01 {
            text-align: center;
            top: 30px;
            left: 50px;
            width: 200px;
        }
    </style>
</head>

<body>
<!-- Layout wrapper -->
<div class="layout-wrapper layout-content-navbar">
    <div class="layout-container">
        <!-- Menu -->
        <div th:include="~{design/side-bar :: side}"></div>
        <!-- / Menu -->

        <!-- Layout container -->
        <div class="layout-page">
            <!-- Navbar -->
            <div th:include="~{design/navi-bar :: navi}"></div>
            <!-- / Navbar -->

            <!-- Content wrapper -->
            <div class="content-wrapper">
                <!-- Content -->
                <div class="container-fluid flex-grow-1 container-p-y">
                    <!-- Layout Demo -->
                    <div class="content">
                        <div class="title">건설일용근로자 표준근로계약서</div>
                        <div class="content">
                            <p> <span th:text="${company.companyInfo.name}"></span> (이하 "사업주"라 함)과(와) <span th:text="${member.memberInfo.name}"></span> (이하 "근로자"라 함)는 다음과 같이 근로계약을 체결한다.</p>
                            <table>
                                <tr>
                                    <th>1. 근로계약기간</th>
                                    <td><span th:text="${#temporals.format(contract.startDate, 'yyyy-MM-dd')}"></span>부터 <span th:text="${#temporals.format(contract.endDate, 'yyyy-MM-dd')}"></span>까지 <br> ※ 근로계약기간을 정하지 않는 경우에는 "근로개시일"만 기재</td>
                                </tr>
                                <tr>
                                    <th>2. 근 무 장 소</th>
                                    <td><span th:text="${contract.location}"></span></td>
                                </tr>
                                <tr>
                                    <th>3. 업무의 내용(직종)</th>
                                    <td><span th:text="${contract.job}"></span></td>
                                </tr>
                                <tr>
                                    <th>4. 소정근로시간</th>
                                    <td><span th:text="${contract.workStartTime}"></span>부터 <span th:text="${contract.workEndTime}"></span>까지 </td>
                                </tr>
                                <tr>
                                    <th>5. 근무일/휴일</th>
                                    <td>매주 <span th:text="${contract.worksSchedule}"></span>일(또는 매일단위)근무 <br> ※ 주휴일은 1주간 소정근로일을 모두 근로한 경우에 주당 1일을 유급으로 부여</td>
                                </tr>
                                <tr>
                                    <th>6. 임 금</th>
                                    <td>
                                        <p>- <span th:text="${contract.wageType}"></span>금: <span th:text="${contract.wage}"></span>원</p>
                                        <p>- 기타 제수당(시간외근로수당, 야간·휴일근로수당 등): <span th:text="${contract.etc}"></span></p>
                                        <p>- 임금지급일: <span th:text="${contract.payDate}"> </span><span th:text="${contract.customPayDate}">일(휴일의 경우는 전일 지급)</span></p>
                                        <p>- 지급방법: <span th:text="${contract.wageInto}"></span></p>
                                    </td>
                                </tr>
                                <tr>
                                    <th>7. 연차유급휴가</th>
                                    <td>연차유급휴가는 근로기준법에서 정하는 바에 따라 부여함</td>
                                </tr>
                                <tr>
                                    <th>8. 사회보험 적용여부</th>
                                    <td>
                                        <p>□ 고용보험(<span th:if="${contract.insurance1=='없음'}" >해당없음</span><span th:unless="${contract.insurance1=='없음'}" >해당</span>)
                                            □ 산재보험(<span th:if="${contract.insurance2=='없음'}" >해당없음</span><span th:unless="${contract.insurance2=='없음'}" >해당</span>)
                                            □ 국민연금(<span th:if="${contract.insurance3=='없음'}" >해당없음</span><span th:unless="${contract.insurance3=='없음'}" >해당</span>)
                                            □ 건강보험(<span th:if="${contract.insurance4=='없음'}" >해당없음</span><span th:unless="${contract.insurance4=='없음'}" >해당</span>)</p>
                                    </td>
                                </tr>
                                <tr>
                                    <th>9. 근로계약서 교부</th>
                                    <td>사업주는 근로계약을 체결함과 동시에 본 계약서를 사본하여 "근로자"의 교부요구와 관계없이 "근로자"에게 교부함(근로기준법 제17조 이행)</td>
                                </tr>
                                <tr>
                                    <th>10. 근로계약, 취업규칙 등의 성실한 이행의무</th>
                                    <td>사업주와 근로자는 각각 근로계약, 취업규칙, 단체협약을 지키고 성실하게 이행하여야 함</td>
                                </tr>
                                <tr>
                                    <th>11. 기 타</th>
                                    <td>이 계약에 정함이 없는 사항은 근로기준법령에 의함</td>
                                </tr>
                            </table>
                            <br>
                            <h3><span th:text="${#temporals.format(contract.contractDate, 'yyyy-MM-dd')}"></span></h3>
                            <h4>사업주 </h4>
                            <h4>사업체 명 : <span th:text="${company.companyInfo.companyName}"> </span> (전화: <span th:text="${company.phone}"> </span>)</h4>
                            <h4>주소: <span th:text="${company.address}"> </span></h4>
                            <h4>대표자: <span th:text="${company.companyInfo.name}"> </span><img src="/upload/contract/signature.png" id="img01" width=150 height="75"/></h4>
                            <h4>근로자 </h4>
                            <h4>연락처 : <span th:text="${member.phone}"> </span></h4>
                            <h4>주소: <span th:text="${member.address}"> </span></h4>
                            <h4>성 함: <span th:text="${member.memberInfo.name}"> </span></h4>
                            <br>
                            <input type="hidden" name="contractId" id="contractId" th:value="${contract.id}">
                            <p style="text-align: center;">
                                <button id="signButton" >서명하기</button>
                            </p>
                            <div class="wrapper">
                                <canvas id="signature-pad" class="signature-pad" width=400 height=200></canvas>
                            </div>
                            <button id="save-png" style="display: none;">저장</button>
                            <button id="clear" style="display: none;">다시쓰기</button>
                        </div>
                    </div>
                </div>
                <!-- / Content -->

                <!-- Footer -->
                <!-- / Footer -->

                <div class="content-backdrop fade"></div>
            </div>
            <!-- Content wrapper -->
        </div>
        <!-- / Layout page -->
    </div>

    <!-- Overlay -->
    <div class="layout-overlay layout-menu-toggle"></div>
</div>
<!-- / Layout wrapper -->

<!-- Signature Pad Script -->
<script src="https://cdn.jsdelivr.net/npm/signature_pad@4.0.0/dist/signature_pad.umd.min.js"></script>
<script>
    $(function () {
       var canvas = document.getElementById('signature-pad');
       var signaturePad = new SignaturePad(canvas, {
           backgroundColor: 'rgb(255, 255, 255, 0)',
           penColor: "rgb(1, 2, 3)"
       });

       document.getElementById('signButton').addEventListener('click', function () {
           $('.wrapper').show();
           $('#signButton').hide();
           $('#img01').hide();
           $('#save-png').show();
           $('#clear').show();
       });

       document.getElementById('save-png').addEventListener('click', function () {
           if (signaturePad.isEmpty()) {
               return alert("Please provide a signature first.");
           }

           var dataURL = signaturePad.toDataURL('image/png');
           var blob = dataURLToBlob(dataURL);
           var formData = new FormData();
           formData.append("signature", blob, "signature.png");
           formData.append("contractId", document.getElementById('contractId').value);
           $.ajax({
               url: '/recruit/saveSignature',
               type: 'POST',
               data: formData,
               processData: false,
               contentType: false,
               success: function (response) {
                   console.log(response.signName)
                   $("#img01").attr('src', response.signName);
                   $('.wrapper').hide();
                   $('#img01').show();
                   $('#save-png').hide();
                   $('#clear').hide();
                   $('#signButton').hide();
               },
               error: function (error) {
                   console.error("Error saving signature: ", error);
               }
           });
       });
   document.getElementById('clear').addEventListener('click', function () {
           signaturePad.clear();
       });

       function dataURLToBlob(dataURL) {
           var binary = atob(dataURL.split(',')[1]);
           var array = [];
           for (var i = 0; i < binary.length; i++) {
               array.push(binary.charCodeAt(i));
           }
           return new Blob([new Uint8Array(array)], { type: 'image/png' });
       }
   });
</script>
</body>
</html>
